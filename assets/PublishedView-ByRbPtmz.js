import{d as j,G as q,o as E,c as _,f as n,w as o,b as s,C as M,D as S,x as l,y as i,j as d,a as t,B,F as b,z as U}from"./index-Ndv9oC7V.js";import{r as H,s as I}from"./use-app-KZmNw3qd.js";const J={class:"bg-white flex-1 w-full min-h-0 px-6 py-5"},K={class:"w-full"},O={class:"border-b"},Q={class:"py-3 px-4 w-2/3"},X={class:"flex items-center gap-2"},Y={class:"py-3 px-4 w-1/12"},Z={class:"py-3 px-4"},$={class:"flex items-center gap-3"},ee={class:"flex items-center"},te={class:"bg-gray-100 h-8 leading-8 px-3 rounded-tl-lg rounded-bl-lg text-gray-700 w-[300px] max-w-[360px] line-clamp-1 break-all"},se=["href"],le=j({__name:"PublishedView",setup(oe){const g=M(),A=S(),{loading:R,published_config:r,loadPublishedConfig:T}=H(),{loading:V,token:z,handleRegenerateWebAppToken:F}=I(),f=q(()=>{var a,e,p,c;return((e=(a=r.value)==null?void 0:a.web_app)==null?void 0:e.status)==="published"?N("web-apps-index",{token:(c=(p=r.value)==null?void 0:p.web_app)==null?void 0:c.token}):""}),N=(a,e={},p={})=>{const{href:c}=A.resolve({name:a,params:e,query:p});return window.location.origin+c};return E(()=>{var a;T((a=g.params)==null?void 0:a.app_id)}),(a,e)=>{const p=l("a-alert"),c=l("icon-compass"),W=l("a-avatar"),D=l("icon-minus-circle"),m=l("a-tag"),G=l("icon-check-circle-fill"),x=l("a-button"),L=l("a-spin");return i(),_("div",J,[n(p,{class:"mb-5"},{default:o(()=>e[1]||(e[1]=[d(" 如应用访问链接或二维码意外泄露，请及时重新生成或进行停止分发，避免资源出现异常消耗 ")])),_:1}),n(L,{loading:s(R),class:"w-full"},{default:o(()=>{var h,w,y,k,v,C;return[t("table",K,[e[6]||(e[6]=t("thead",null,[t("tr",{class:"h-10 bg-gray-100"},[t("th",{class:"font-normal text-left px-4 text-gray-700 border-r border-white"},"发布渠道"),t("th",{class:"font-normal text-left px-4 text-gray-700 border-r border-white"},"状态"),t("th",{class:"font-normal text-left px-4 text-gray-700"},"操作")])],-1)),t("tbody",null,[t("tr",O,[t("td",Q,[t("div",X,[n(W,{size:36,shape:"square",class:"bg-blue-100"},{default:o(()=>[n(c,{size:18,class:"text-blue-700"})]),_:1}),e[2]||(e[2]=t("div",{class:"flex flex-col"},[t("div",{class:"text-gray-700 font-semibold"},"网页版"),t("div",{class:"text-gray-500"},"可通过访问PC网页立即开始对话。")],-1))])]),t("td",Y,[((w=(h=s(r))==null?void 0:h.web_app)==null?void 0:w.status)!=="published"?(i(),B(m,{key:0,color:"gray",bordered:""},{icon:o(()=>[n(D)]),default:o(()=>[e[3]||(e[3]=d(" 未发布 "))]),_:1})):(i(),B(m,{key:1,color:"blue",bordered:""},{icon:o(()=>[n(G)]),default:o(()=>[e[4]||(e[4]=d(" 已发布 "))]),_:1}))]),t("td",Z,[t("div",$,[t("div",ee,[t("div",te,[((k=(y=s(r))==null?void 0:y.web_app)==null?void 0:k.status)==="published"?(i(),_(b,{key:0},[d(U(f.value),1)],64)):(i(),_(b,{key:1},[d("应用未发布，无可访问链接")],64))]),n(x,{loading:s(V),disabled:((C=(v=s(r))==null?void 0:v.web_app)==null?void 0:C.status)!=="published",type:"primary",class:"rounded-tr-lg rounded-br-lg px-2",onClick:e[0]||(e[0]=async()=>{var u;await s(F)((u=s(g).params)==null?void 0:u.app_id),s(r).web_app.token=s(z)})},{default:o(()=>e[5]||(e[5]=[d(" 重新生成 ")])),_:1},8,["loading","disabled"])]),n(x,{class:"rounded-lg px-2"},{default:o(()=>{var u,P;return[((P=(u=s(r))==null?void 0:u.web_app)==null?void 0:P.status)!=="published"?(i(),_(b,{key:0},[d(" 立即访问 ")],64)):(i(),_("a",{key:1,href:f.value,target:"_blank"},"立即访问",8,se))]}),_:1})])])])])])]}),_:1},8,["loading"])])}}});export{le as default};
